---
title: "HW1_207"
author: "RafaelCatoiaPulgrossi"
date: "2023-04-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Ex 1

```{r}
posterior_prop <- function(theta){
  
  return(
    (theta^3)*(1-theta)^13+
      (theta^4)*(1-theta)^12+
      (theta^5)*(1-theta)^11
  )
}

parametric_space <- seq(0.001,1,0.001)

plot(parametric_space,posterior_prop(theta=parametric_space),
     type='l',ylab='proportional to the density')
```


# Ex 5

## a 
```{r}
y <- c(43,44,45,46.5,47.5)
M=1000

parametric_space <- seq(0,100,1/M)

q_theta_given_y = function(x,theta){
  result <- 1
  for ( i in 1:length(x)){
    result = result * (1/(1+(x[i]-theta)^2))
  }
  return(result/100)
}


## unormalized density
unormalized_density <- q_theta_given_y(y,parametric_space)

## summing the heights of the bins
normalizing_constant <-  sum(unormalized_density/M)

#plotting the normalized density
plot(parametric_space,
     unormalized_density/normalizing_constant,
     type='l',
     ylab = 'normalized density')

normalized_density <-  unormalized_density/normalizing_constant
```

## b
```{r}
sample_theta <- sample(parametric_space,prob = normalized_density,size = 1000)
hist(sample_theta)
```

## c
```{r}
set.seed(57)
predictive_distribution <- rcauchy(1000,scale = 1,location = sample_theta)
plot(density(predictive_distribution))

plot(density(predictive_distribution),xlim=c(30,60))
abline(v=mean(y),col='forestgreen')
mean(predictive_distribution) ; sd(predictive_distribution)
```




# Ex 6

```{r Gibbs}

x_given_y <- function(constant,y){
  a <- max(0,y-constant)
  b <- min(y+constant,1)
  return(runif(1,a,b))
}

y_given_x <- function(constant,x){
  a <- max(0,x-constant)
  b <- min(x+constant,1)
  return(runif(1,a,b))
}


gibbs_ex6 <- function(B=1000,constant){
  set.seed(1000)
  samples <- data.frame(x=NA,y=NA)
  new_x <- 0.5 #initial value for x
  for(i in 1:(B)){
    #calculating p(y|x=new_x)
    new_y <- y_given_x(x = new_x,constant = constant) 
    #calculating p(x|y=new_y)
    new_x <- x_given_y(y = new_y,constant = constant)
    samples <-rbind(samples, c(new_x,new_y))
  }
  return(samples[-1,])
}

sample_0.3 <- gibbs_ex6(B = 1000,0.3)
sample_0.2 <- gibbs_ex6(B = 1000,0.2)
sample_0.1 <- gibbs_ex6(B = 1000,0.1)


par(mfrow=c(3,4))
constant<-0.3
plot(sample_0.3$x,type='l',col=scales::alpha('deepskyblue',0.5))
lines(sample_0.3$y,type='l',col=scales::alpha('firebrick',0.5))
plot(sample_0.3)
abline(constant,1,col='blue')
abline(-constant,1,col='blue')
abline(0,1,col='blue')
acf(sample_0.3$x)
acf(sample_0.3$y)

constant<-0.2
plot(sample_0.2$x,type='l',col=scales::alpha('deepskyblue',0.5))
lines(sample_0.2$y,type='l',col=scales::alpha('firebrick',0.5))
plot(sample_0.2)
abline(constant,1,col='blue')
abline(-constant,1,col='blue')
abline(0,1,col='blue')
acf(sample_0.2$x)
acf(sample_0.2$y)

constant<-0.1
plot(sample_0.1$x,type='l',col=scales::alpha('deepskyblue',0.5))
lines(sample_0.1$y,type='l',col=scales::alpha('firebrick',0.5))
plot(sample_0.1)
abline(constant,1,col='blue')
abline(-constant,1,col='blue')
abline(0,1,col='blue')
acf(sample_0.1$x)
acf(sample_0.1$y)

```




# Ex 8 - 3.4


# Ex 10 
