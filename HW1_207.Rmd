---
title: "HW1_207"
author: "RafaelCatoiaPulgrossi"
date: "2023-04-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Ex 1

```{r}
posterior_prop <- function(theta){
  
  return(
    (theta^3)*(1-theta)^13+
      (theta^4)*(1-theta)^12+
      (theta^5)*(1-theta)^11
  )
}

parametric_space <- seq(0.001,1,0.001)

plot(parametric_space,posterior_prop(theta=parametric_space),
     type='l',ylab='proportional to the density')
```


# Ex 5


# Ex 6

```{r Gibbs}

x_given_y <- function(constant,y){
  b <- max(0,y-constant)
  a <- min(y+constant,1)
  return(runif(a,b))
}

y_given_x <- function(constant,x){
  b <- max(0,x-constant)
  a <- min(x+constant,1)
  return(runif(a,b))
}

constant = 0.3

gibbs_ex6 <- function(B=1000,constant,skip=100,burn_in=1000){
  set.seed(1000)
  samples <- data.frame(x=NA,y=NA)
  new_x <- 0.5
  for(i in 1:(B*skip)){
    new_y <- y_given_x(x = new_x,constant = constant)
    new_x <- x_given_y(y = new_y,constant = constant)
    if ((i %% skip) == 0 & i>burn_in){
      samples <- rbind(samples,c(new_x,new_y))
    }
  }
  return(samples[-1,])
}

sample_0.3 <- gibbs_ex6(B = 1000,0.3,skip=1000)
sample_0.2 <- gibbs_ex6(B = 1000,0.2,skip=1000)
sample_0.1 <- gibbs_ex6(B = 1000,0.1,skip=1000)

plot(sample_0.3$x,type='l')
plot(sample_0.3)
acf(sample_0.3$x)

plot(sample_0.2$x,type='l')
plot(sample_0.2)
acf(sample_0.2$x)

plot(sample_0.1$x,type='l')
plot(sample_0.1)
acf(sample_0.1$x)


par(mfrow=c(1,3))
plot(sample_0.3$x,type='l')
plot(sample_0.2$x,type='l')
plot(sample_0.1$x,type='l')
par(mfrow=c(1,1))
```




# Ex 8 - 3.4


# Ex 10 
